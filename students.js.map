{"version":3,"file":"students.js","sources":["../src/js/students/studentsApi.js","../src/js/students/refs.js","../src/js/students/markup.js","../src/js/students/basicLightbox.js","../src/js/students/modalTextContent.js","../src/js/students/students.js"],"sourcesContent":["export const getStudents = () => {\n  return fetch('https://65d763b227d9a3bc1d7aea8d.mockapi.io/students').then(\n    response => {\n      if (!response.ok) {\n        throw new Error(response.message);\n      }\n\n      return response.json();\n    }\n  );\n};\n\nexport const setStudent = student => {\n  return fetch('https://65d763b227d9a3bc1d7aea8d.mockapi.io/students', {\n    method: 'POST',\n    headers: { 'content-type': 'application/json' },\n    body: JSON.stringify(student),\n  }).then(response => {\n    if (!response.ok) {\n      throw new Error(response.message);\n    }\n\n    return response.json();\n  });\n};\n\nexport const deleteStudent = studentId => {\n  return fetch(`https://65d763b227d9a3bc1d7aea8d.mockapi.io/students/${studentId}`, {\n    method: 'DELETE',\n  }).then(response => {\n    if (!response.ok) {\n      throw new Error(response.message);\n    }\n\n    return response.json();\n  });\n}\n\nexport const getStudentByID = studentID =>{\n  return fetch(`https://65d763b227d9a3bc1d7aea8d.mockapi.io/students/${studentID}`).then(\n    response => {\n      if (!response.ok) {\n        throw new Error(response.message);\n      }\n\n      return response.json();\n    }\n  );\n}","export const refs = {\n  galleryList: document.querySelector('.gallery'),\n  backdrop: document.querySelector('.backdrop'),\n  errorInfo: document.querySelector('.empty-students'),\n  modalBtn: document.querySelector('.js-modal-btn'),\n};\n","import { format } from 'date-fns';\n\nexport const getItemMarkUp = ({\n  avatar,\n  firstName,\n  id,\n  age,\n  country,\n  city,\n  lastName,\n}) => {\n  const dateOfBirth = format(new Date(age), 'dd MMMM yy');\n\n  return `<li class=\"photo-card\" data-id=${id} >\n            <img\n              src=\"${avatar}\"\n              alt=\"${firstName}\"\n            />\n            <button type=\"button\" class=\"delete-btn js-delete-btn\">&#9988;</button>\n\n            <div class=\"wrapper\">\n              <div class=\"info\" >\n              <b class=\"student-info\">${firstName}</b>\n              <b class=\"student-info\">${lastName}</b>\n              <b class=\"student-info\">${dateOfBirth}</b>\n              </div>\n\n              <div class=\"info\">\n              <b class=\"student-info\">${country}</b>\n              <b class=\"student-info\">${city}</b>\n              </div>\n            </div>\n          </li>`;\n};\nexport const getItemMarkUpDetails = ({\n                                avatar,\n                                firstName,\n                                id,\n                                age,\n                                country,\n                                city,\n                                lastName,\n                                rating\n                              }) => {\n  const dateOfBirth = format(new Date(age), 'dd MMMM yy');\n\n  return `<div class=\"photo-card\" data-id=${id} >\n            <img\n              src=\"${avatar}\"\n              alt=\"${firstName}\"\n            />\n\n            <div class=\"wrapper\">\n              <div class=\"info\" >\n              <b class=\"student-info\">${firstName}</b>\n              <b class=\"student-info\">${lastName}</b>\n              <b class=\"student-info\">${dateOfBirth}</b>\n              </div>\n\n              <div class=\"info\">\n              <b class=\"student-info\">${country}</b>\n              <b class=\"student-info\">${city}</b>\n              </div>\n              <div class=\"info\"><b class=\"student-info\">rating:${rating}</b></div>\n            </div>\n          </div>`;\n};\n","import * as basicLightbox from 'basiclightbox';\n\nexport const instance = basicLightbox.create(\n  '',\n  {\n    onShow: () => {\n      const scrollBarWidth =\n        window.innerWidth - document.documentElement.clientWidth;\n      document.body.style.overflow = 'hidden';\n\n      document.body.style.paddingRight = `${scrollBarWidth}px`\n    },\n    onClose: () => {\n      document.body.style.overflow = 'visible';\n      document.body.style.paddingRight = '';\n    },\n    className: 'backdrop',\n  }\n);\n\n\n","export const modalTextContent = {\n    spinner: '<span class=\"loader\"></span>',\n    form: `\n\t<div class=\"modal\">\n    <form class=\"student-form\">\n      <input name=\"firstName\" placeholder=\"firstName*\" type=\"text\" value=\"mango\" required />\n      <input name=\"lastName\" placeholder=\"lastName*\" type=\"text\" value=\"mango\" required />\n      <input name=\"age\" placeholder=\"Age*\" type=\"text\" value=\"01.01.1990\" required />\n      <input name=\"country\" placeholder=\"Country*\" type=\"text\" value=\"Spain\" required />\n      <input name=\"city\" placeholder=\"City*\" type=\"text\" value=\"Barcelona\" required />\n\n      <button class=\"add-student-btn\">Add Student</button>\n    </form>\n    </div>\n`,\n};","// https://65d763b227d9a3bc1d7aea8d.mockapi.io/students\n\nimport { getStudents, setStudent, deleteStudent, getStudentByID } from './studentsApi';\nimport { refs } from './refs';\nimport { getItemMarkUp, getItemMarkUpDetails } from './markup';\nimport { instance } from './basicLightbox';\nimport { modalTextContent } from './modalTextContent'\n\ninstance.element().innerHTML = modalTextContent['spinner'];\ninstance.show();\ngetStudents()\n  .then(students => {\n    if (!students.length) {\n      refs.errorInfo.classList.remove('is-hidden');\n      return;\n    }\n\n    const markup = students.map(student => getItemMarkUp(student)).join('');\n    refs.galleryList.innerHTML = markup;\n  })\n  .catch(err => {\n    refs.errorInfo.classList.remove('is-hidden');\n    refs.errorInfo.classList.add('error');\n    refs.errorInfo.textContent = 'something went wrong';\n  })\n  .finally(() => instance.close());\n\nrefs.modalBtn.addEventListener('click', () => {\n  instance.show();\n  instance.element().innerHTML = modalTextContent['form'];\n  instance\n    .element()\n    .querySelector('.student-form')\n    .addEventListener('submit', e => {\n      e.preventDefault();\n\n      const { firstName, lastName, age, country, city } = e.target.elements;\n\n      const student = {\n        firstName: firstName.value,\n        lastName: lastName.value,\n        age: age.value,\n        country: country.value,\n        city: city.value,\n      };\n\n      instance.element().innerHTML = modalTextContent['spinner'];\n\n      setStudent(student)\n        .then(student => {\n          const markup = getItemMarkUp(student);\n          refs.galleryList.insertAdjacentHTML('beforeend', markup);\n\n          if (!refs.errorInfo.classList.contains('is-hidden')) {\n            refs.errorInfo.classList.add('is-hidden');\n          }\n        })\n        .catch(err => {\n          console.log(err);\n          refs.errorInfo.classList.remove('is-hidden');\n          refs.errorInfo.classList.add('error');\n          refs.errorInfo.textContent = `something went wrong. ${err.message}`;\n        })\n        .finally(() => instance.close());\n    });\n});\n\nrefs.galleryList.addEventListener('click', e => {\n  if(e.target.nodeName === \"UL\") return;\n  const item = e.target.closest('.photo-card');\n\n  instance.element().innerHTML = modalTextContent['spinner'];\n  instance.show()\n\n  if (e.target.classList.contains('js-delete-btn')) {\n    deleteStudent(item.dataset.id)\n      .then(() => {\n        item.remove();\n      })\n      .catch(err => {\n        refs.errorInfo.classList.remove('is-hidden');\n        refs.errorInfo.classList.add('error');\n        refs.errorInfo.textContent = 'something went wrong';\n      })\n      .finally(()=> instance.close());\n    return;\n  }\n\n  getStudentByID(item.dataset.id).then(data => instance.element().innerHTML = getItemMarkUpDetails(data))\n    .catch(err => {\n      instance.element().innerHTML = `<p class=\"empty-students error\">\n          We cannot receive any info about the student...\n        </p>`\n      setTimeout(() => instance.close(), 1500)\n    })\n});\n"],"names":["getStudents","response","setStudent","student","deleteStudent","studentId","getStudentByID","studentID","refs","getItemMarkUp","avatar","firstName","id","age","country","city","lastName","dateOfBirth","format","getItemMarkUpDetails","rating","instance","basicLightbox.create","scrollBarWidth","modalTextContent","students","markup","err","item","data"],"mappings":"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"}