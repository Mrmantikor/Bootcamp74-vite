{"version":3,"file":"students.js","sources":["../src/js/students/studentsApi.js","../src/js/students/refs.js","../src/js/students/markup.js","../src/js/students/basicLightbox.js","../src/js/students/modalTextContent.js","../src/js/students/students.js"],"sourcesContent":["export const getStudents = () => {\n  return fetch('https://65d763b227d9a3bc1d7aea8d.mockapi.io/students').then(\n    response => {\n      if (!response.ok) {\n        throw new Error(response.message);\n      }\n\n      return response.json();\n    }\n  );\n};\n\nexport const setStudent = student => {\n  return fetch('https://65d763b227d9a3bc1d7aea8d.mockapi.io/students', {\n    method: 'POST',\n    headers: { 'content-type': 'application/json' },\n    body: JSON.stringify(student),\n  }).then(response => {\n    if (!response.ok) {\n      throw new Error(response.message);\n    }\n\n    return response.json();\n  });\n};\n\nexport const deleteStudent = studentId => {\n  return fetch(`https://65d763b227d9a3bc1d7aea8d.mockapi.io/students/${studentId}`, {\n    method: 'DELETE',\n  }).then(response => {\n    if (!response.ok) {\n      throw new Error(response.message);\n    }\n\n    return response.json();\n  });\n}\n","export const refs = {\n  galleryList: document.querySelector('.gallery'),\n  backdrop: document.querySelector('.backdrop'),\n  errorInfo: document.querySelector('.empty-students'),\n  modalBtn: document.querySelector('.js-modal-btn'),\n};\n","import { format } from 'date-fns';\n\nexport const getItemMarkUp = ({\n  avatar,\n  firstName,\n  id,\n  age,\n  country,\n  city,\n  lastName,\n}) => {\n  const dateOfBirth = format(new Date(age), 'dd MMMM yy');\n\n  return `<li class=\"photo-card\">\n            <img\n              src=\"${avatar}\"\n              alt=\"${firstName}\"\n            />\n            <button data-id=${id} type=\"button\" class=\"delete-btn js-delete-btn\">&#9988;</button>\n    \n            <div class=\"wrapper\">\n              <div class=\"info\" >\n              <b class=\"student-info\">${firstName}</b>\n              <b class=\"student-info\">${lastName}</b>\n              <b class=\"student-info\">${dateOfBirth}</b>\n              </div>\n    \n              <div class=\"info\">\n              <b class=\"student-info\">${country}</b>\n              <b class=\"student-info\">${city}</b>\n              </div>\n            </div>\n          </li>`;\n};\n","import * as basicLightbox from 'basiclightbox';\n\nexport const instance = basicLightbox.create(\n  '',\n  {\n    onShow: () => {\n      const scrollBarWidth =\n        window.innerWidth - document.documentElement.clientWidth;\n      document.body.style.overflow = 'hidden';\n      console.log(scrollBarWidth);\n      document.body.style.paddingRight = `${scrollBarWidth}px`\n    },\n    onClose: () => {\n      document.body.style.overflow = 'visible';\n      document.body.style.paddingRight = '';\n    },\n    className: 'backdrop',\n  }\n);\n\n\n// `\n// \t<div class=\"modal\">\n//     <form class=\"student-form\">\n//       <input name=\"firstName\" placeholder=\"firstName*\" type=\"text\" required />\n//       <input name=\"lastName\" placeholder=\"lastName*\" type=\"text\" required />\n//       <input name=\"age\" placeholder=\"Age*\" type=\"text\" required />\n//       <input name=\"country\" placeholder=\"Country*\" type=\"text\" required />\n//       <input name=\"city\" placeholder=\"City*\" type=\"text\" required />\n\n//       <button class=\"add-student-btn\">Add Student</button>\n//     </form>\n//     </div>\n// `","export const modalTextContent = {\n    spinner: '<span class=\"loader\"></span>',\n    form: `\n\t<div class=\"modal\">\n    <form class=\"student-form\">\n      <input name=\"firstName\" placeholder=\"firstName*\" type=\"text\" required />\n      <input name=\"lastName\" placeholder=\"lastName*\" type=\"text\" required />\n      <input name=\"age\" placeholder=\"Age*\" type=\"text\" required />\n      <input name=\"country\" placeholder=\"Country*\" type=\"text\" required />\n      <input name=\"city\" placeholder=\"City*\" type=\"text\" required />\n\n      <button class=\"add-student-btn\">Add Student</button>\n    </form>\n    </div>\n`,\n};","// https://65d763b227d9a3bc1d7aea8d.mockapi.io/students\n\nimport { getStudents, setStudent, deleteStudent } from './studentsApi';\nimport { refs } from './refs';\nimport { getItemMarkUp } from './markup';\nimport { instance } from './basicLightbox';\nimport { modalTextContent } from './modalTextContent'\n\ninstance.element().innerHTML = modalTextContent['spinner'];\ninstance.show();\ngetStudents()\n  .then(students => {\n    if (!students.length) {\n      refs.errorInfo.classList.remove('is-hidden');\n      return;\n    }\n\n    const markup = students.map(student => getItemMarkUp(student)).join('');\n    refs.galleryList.innerHTML = markup;\n  })\n  .catch(err => {\n    refs.errorInfo.classList.remove('is-hidden');\n    refs.errorInfo.classList.add('error');\n    refs.errorInfo.textContent = 'something went wrong';\n  })\n  .finally(() => instance.close());\n\nrefs.modalBtn.addEventListener('click', () => {\n  instance.show();\n  instance.element().innerHTML = modalTextContent['form'];\n  instance\n    .element()\n    .querySelector('.student-form')\n    .addEventListener('submit', e => {\n      e.preventDefault();\n\n      const { firstName, lastName, age, country, city } = e.target.elements;\n\n      const student = {\n        firstName: firstName.value,\n        lastName: lastName.value,\n        age: age.value,\n        country: country.value,\n        city: city.value,\n      };\n\n      instance.element().innerHTML = modalTextContent['spinner'];\n\n      setStudent(student)\n        .then(student => {\n          const markup = getItemMarkUp(student);\n          refs.galleryList.insertAdjacentHTML('beforeend', markup);\n\n          if (!refs.errorInfo.classList.contains('is-hidden')) {\n            refs.errorInfo.classList.add('is-hidden');\n          }\n        })\n        .catch(err => {\n          console.log(err);\n          refs.errorInfo.classList.remove('is-hidden');\n          refs.errorInfo.classList.add('error');\n          refs.errorInfo.textContent = `something went wrong. ${err.message}`;\n        })\n        .finally(() => instance.close());\n    });\n});\n\nrefs.galleryList.addEventListener('click', e => {\n  const { target } = e;\n  if (!target.classList.contains('js-delete-btn')) {\n    return;\n  }\n\n  const item = target.closest('.photo-card');\n\n  deleteStudent(target.dataset.id)\n    .then(() => {\n      item.remove();\n    })\n    .catch(err => {\n      refs.errorInfo.classList.remove('is-hidden');\n      refs.errorInfo.classList.add('error');\n      refs.errorInfo.textContent = 'something went wrong';\n    });\n});\n"],"names":["getStudents","response","setStudent","student","deleteStudent","studentId","refs","getItemMarkUp","avatar","firstName","id","age","country","city","lastName","dateOfBirth","format","instance","basicLightbox.create","scrollBarWidth","modalTextContent","students","markup","err","target","item"],"mappings":"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"}