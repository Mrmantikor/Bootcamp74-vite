{"version":3,"file":"photos.js","sources":["../src/js/photos/markup.js","../src/js/photos/pexelsAPI.js","../src/js/photos/refs.js","../src/js/photos/photos.js"],"sourcesContent":["export const createMarkup = photos => {\n  return photos\n    .map(\n      ({ src, alt }) => `<li class=\"gallery__item\">\n   <a href=\"${src.large}\"> <img src=\"${src.medium}\" alt=\"${alt}\" class=\"gallery-img\"></a>\n</li>`\n    )\n    .join('');\n};\n","import axios from 'axios';\n\nconst API_KEY = '563492ad6f9170000100000108dc2880626e4436b3634ce1cf6b4d74';\n\naxios.defaults.headers.common['Authorization'] = API_KEY;\naxios.defaults.baseURL = 'https://api.pexels.com/v1';\naxios.defaults.params = {\n  color: 'black',\n  orientation: 'landscape',\n  per_page: 20,\n};\n\nexport const fetchPhotos = async function (query, page) {\n  const { data } = await axios.get(`/search?query=${query}&page=${page}`);\n\n  return data;\n};\n","export const refs = {\n  form: document.querySelector('.js-search-form'),\n  gallery: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.js-loader'),\n  loadmore: document.querySelector('.js-load-more'),\n};\n","import { createMarkup } from './markup';\nimport { fetchPhotos } from './pexelsAPI';\nimport { refs } from './refs';\nimport iziToast from 'izitoast';\nimport Simplelightbox from 'simplelightbox';\n\nconst lightbox = new Simplelightbox('.js-gallery a');\nlet page = 1;\nlet query = '';\nlet totalPages = 0;\n\nconst onSubmit = async function (e) {\n  e.preventDefault();\n  query = e.target.elements['query'].value.trim();\n  page = 1;\n\n  e.target.reset();\n\n  if (query === '') {\n    showMessage('Input cannot be empty', 'error');\n    return;\n  }\n  refs.loader.classList.remove('is-hidden');\n  refs.loadmore.classList.add('is-hidden');\n  try {\n    const { photos, per_page, total_results } = await fetchPhotos(query, page);\n\n    if (!photos.length) {\n      refs.loadmore.classList.add('is-hidden');\n      refs.gallery.innerHTML = '';\n      showMessage(\"We don't found photos matching your query\", 'error');\n      return;\n    }\n\n    totalPages = Math.ceil(total_results / per_page);\n    if (page < totalPages) {\n      refs.loadmore.classList.remove('is-hidden');\n    }\n\n    showMessage('We found photos matching your query', 'success');\n\n    const markup = createMarkup(photos);\n    refs.gallery.innerHTML = markup;\n\n    lightbox.refresh();\n  } catch (error) {\n    showMessage(`Something went wrong ${error.message}`, 'error');\n  } finally {\n    refs.loader.classList.add('is-hidden');\n  }\n};\n\nrefs.form.addEventListener('submit', onSubmit);\n\nconst showMessage = function (message, type = 'info') {\n  iziToast[type]({\n    message,\n    position: 'topRight',\n  });\n};\nrefs.loadmore.addEventListener('click', async () => {\n  page++;\n\n  if (page === totalPages) {\n    refs.loadmore.classList.add('is-hidden');\n  }\n\n  refs.loader.classList.remove('is-hidden');\n\n  try {\n    const { photos } = await fetchPhotos(query, page);\n    const markup = createMarkup(photos);\n    refs.gallery.insertAdjacentHTML('beforeend', markup);\n    const itemHeight = refs.gallery.children[0].getBoundingClientRect().height;\n\n    // window.scrollBy({ top: itemHeight * 2, behavior: 'smooth', });\n\n    smoothScrollBy(itemHeight * 2, 1000);\n\n    lightbox.refresh();\n  } catch (error) {\n    showMessage(`Something went wrong ${error.message}`, 'error');\n  } finally {\n    refs.loader.classList.add('is-hidden');\n  }\n});\n\nconst smoothScrollBy = (targetScroll, duration) => {\n  const start = window.scrollY;\n  const startTime = performance.now();\n\n  const animateScroll = currentTime => {\n    const elapsedTime = currentTime - startTime;\n    const progress = Math.min(elapsedTime / duration, 1);\n\n    const easeOutCubic = t => 1 - Math.pow(1 - t, 3);\n\n    const newPosition = start + targetScroll * easeOutCubic(progress);\n    window.scrollTo(0, newPosition);\n\n    if (progress < 1) {\n      requestAnimationFrame(animateScroll);\n    }\n  };\n\n  requestAnimationFrame(animateScroll);\n};\n\n// const scrollSmoothly = () => {\n//   const firstCard = document.querySelector('.gallery-item');\n//   if (!firstCard) return;\n\n//   const cardHeight = firstCard.getBoundingClientRect().height;\n//   smoothScrollBy(cardHeight * 2, 600);\n// };\n"],"names":["createMarkup","photos","src","alt","API_KEY","axios","fetchPhotos","query","page","data","refs","lightbox","Simplelightbox","totalPages","onSubmit","showMessage","per_page","total_results","markup","error","message","type","iziToast","itemHeight","smoothScrollBy","targetScroll","duration","start","startTime","animateScroll","currentTime","elapsedTime","progress","newPosition","t"],"mappings":"kHAAO,MAAMA,EAAeC,GACnBA,EACJ,IACC,CAAC,CAAE,IAAAC,EAAK,IAAAC,CAAG,IAAO;AAAA,cACVD,EAAI,KAAK,gBAAgBA,EAAI,MAAM,UAAUC,CAAG;AAAA,MAE9D,EACK,KAAK,EAAE,ECLNC,EAAU,2DAEhBC,EAAM,SAAS,QAAQ,OAAO,cAAmBD,EACjDC,EAAM,SAAS,QAAU,4BACzBA,EAAM,SAAS,OAAS,CACtB,MAAO,QACP,YAAa,YACb,SAAU,EACZ,EAEO,MAAMC,EAAc,eAAgBC,EAAOC,EAAM,CACtD,KAAM,CAAE,KAAAC,CAAI,EAAK,MAAMJ,EAAM,IAAI,iBAAiBE,CAAK,SAASC,CAAI,EAAE,EAEtE,OAAOC,CACT,EChBaC,EAAO,CAClB,KAAM,SAAS,cAAc,iBAAiB,EAC9C,QAAS,SAAS,cAAc,aAAa,EAC7C,OAAQ,SAAS,cAAc,YAAY,EAC3C,SAAU,SAAS,cAAc,eAAe,CAClD,ECCMC,EAAW,IAAIC,EAAe,eAAe,EACnD,IAAIJ,EAAO,EACPD,EAAQ,GACRM,EAAa,EAEjB,MAAMC,EAAW,eAAgB,EAAG,CAOlC,GANA,EAAE,eAAgB,EAClBP,EAAQ,EAAE,OAAO,SAAS,MAAS,MAAM,KAAM,EAC/CC,EAAO,EAEP,EAAE,OAAO,MAAO,EAEZD,IAAU,GAAI,CAChBQ,EAAY,wBAAyB,OAAO,EAC5C,MACJ,CACEL,EAAK,OAAO,UAAU,OAAO,WAAW,EACxCA,EAAK,SAAS,UAAU,IAAI,WAAW,EACvC,GAAI,CACF,KAAM,CAAE,OAAAT,EAAQ,SAAAe,EAAU,cAAAC,CAAe,EAAG,MAAMX,EAAYC,EAAOC,CAAI,EAEzE,GAAI,CAACP,EAAO,OAAQ,CAClBS,EAAK,SAAS,UAAU,IAAI,WAAW,EACvCA,EAAK,QAAQ,UAAY,GACzBK,EAAY,4CAA6C,OAAO,EAChE,MACN,CAEIF,EAAa,KAAK,KAAKI,EAAgBD,CAAQ,EAC3CR,EAAOK,GACTH,EAAK,SAAS,UAAU,OAAO,WAAW,EAG5CK,EAAY,sCAAuC,SAAS,EAE5D,MAAMG,EAASlB,EAAaC,CAAM,EAClCS,EAAK,QAAQ,UAAYQ,EAEzBP,EAAS,QAAS,CACnB,OAAQQ,EAAO,CACdJ,EAAY,wBAAwBI,EAAM,OAAO,GAAI,OAAO,CAChE,QAAY,CACRT,EAAK,OAAO,UAAU,IAAI,WAAW,CACzC,CACA,EAEAA,EAAK,KAAK,iBAAiB,SAAUI,CAAQ,EAE7C,MAAMC,EAAc,SAAUK,EAASC,EAAO,OAAQ,CACpDC,EAASD,CAAI,EAAE,CACb,QAAAD,EACA,SAAU,UACd,CAAG,CACH,EACAV,EAAK,SAAS,iBAAiB,QAAS,SAAY,CAClDF,IAEIA,IAASK,GACXH,EAAK,SAAS,UAAU,IAAI,WAAW,EAGzCA,EAAK,OAAO,UAAU,OAAO,WAAW,EAExC,GAAI,CACF,KAAM,CAAE,OAAAT,CAAQ,EAAG,MAAMK,EAAYC,EAAOC,CAAI,EAC1CU,EAASlB,EAAaC,CAAM,EAClCS,EAAK,QAAQ,mBAAmB,YAAaQ,CAAM,EACnD,MAAMK,EAAab,EAAK,QAAQ,SAAS,CAAC,EAAE,sBAAqB,EAAG,OAIpEc,EAAeD,EAAa,EAAG,GAAI,EAEnCZ,EAAS,QAAS,CACnB,OAAQQ,EAAO,CACdJ,EAAY,wBAAwBI,EAAM,OAAO,GAAI,OAAO,CAChE,QAAY,CACRT,EAAK,OAAO,UAAU,IAAI,WAAW,CACzC,CACA,CAAC,EAED,MAAMc,EAAiB,CAACC,EAAcC,IAAa,CACjD,MAAMC,EAAQ,OAAO,QACfC,EAAY,YAAY,IAAK,EAE7BC,EAAgBC,GAAe,CACnC,MAAMC,EAAcD,EAAcF,EAC5BI,EAAW,KAAK,IAAID,EAAcL,EAAU,CAAC,EAI7CO,EAAcN,EAAQF,GAFPS,GAAK,EAAI,KAAK,IAAI,EAAIA,EAAG,CAAC,GAESF,CAAQ,EAChE,OAAO,SAAS,EAAGC,CAAW,EAE1BD,EAAW,GACb,sBAAsBH,CAAa,CAEtC,EAED,sBAAsBA,CAAa,CACrC"}